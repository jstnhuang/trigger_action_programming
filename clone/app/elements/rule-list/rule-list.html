<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">

<polymer-element name="rule-list" attributes="rules">
  <template>
    <link rel="stylesheet" href="rule-list.css">
    <paper-shadow class="listContainer">
      <template if="{{ rules.length == 0 }}">
        <p class="noRules">No rules have been created yet.</p>
      </template>
      <template repeat="{{ rule in rules }}">
        <template if="{{rule.mode == 'update' || rule.mode == 'create'}}">
          <paper-shadow z="2">
            <rule-card mode="{{rule.mode}}" triggers="{{rule.triggers}}" action="{{rule.action}}" on-delete-rule="{{deleteRule}}"></rule-card>
          </paper-shadow>
        </template>
        <template if="{{rule.mode != 'update' && rule.mode != 'create'}}">
          <rule-card mode="{{rule.mode}}" triggers="{{rule.triggers}}" action="{{rule.action}}"></rule-card>
        </template>
      </template>
    </paper-shadow>
  </template>
  <script>
    (function () {
      Polymer({
        ready: function () {
        },
        newRule: function() {
          var newRule = {
            'triggers': [{}],
            'action': {},
            mode: 'create'
          };
          this.rules.unshift(newRule);
        },
        deleteRule: function(e, detail, sender) {
          sender.id = 'delete';
          var parent = sender.parentNode;
          parent.removeChild(sender);
        }
      });
    })();
  </script>
</polymer-element>
