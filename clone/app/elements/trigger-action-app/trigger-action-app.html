<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../rule-list/rule-list.html">

<polymer-element name="trigger-action-app" attributes="readOnly">
  <style>
    paper-action-dialog {
      width: 100%;
    }
  </style>
  <template>
    <link rel="stylesheet" href="trigger-action-app.css">
    <template if="{{!readOnly}}">
      <paper-button raised id="createButton" on-click="{{createRule}}" title="Click to create a rule.">Create a rule</paper-button>
    </template>
    <rule-list id="ruleList" readOnly="{{readOnly}}" rules="{{rules}}" on-save-rule="{{ruleSaved}}" on-delete-rule="{{ruleDeleted}}"></rule-list>
  </template>
  <script>
    (function () {
      Polymer({
        ready: function () {
          this.rules = [
            {
              triggers: [
                {
                  key: 'my_location',
                  displayName: 'My location',
                  params: {
                    verb: 'am currently at',
                    location: 'home'
                  }
                }
              ],
              action: {
                key: 'set_thermostat',
                displayName: 'Set thermostat',
                params: {
                  onOrOff: "on",
                  temperature: 72,
                }
              },
              name: 'If I am currently at home, then set the thermostat to 72 degrees'
            },
            {
              triggers: [
                {
                  key: 'daily_time',
                  displayName: 'Daily time',
                  params: {
                    endHour: 17,
                    endMinute: 0,
                    isOrBetween: "is",
                    startHour: 8,
                    startMinute: 0
                  }
                }
              ],
              action: {
                key: 'send_email',
                displayName: 'Send email',
                params: {
                  content: "Test sentence 1. Test sentence 2. Long test sentence. Test sentence 1. Test sentence 2. Long test sentence. Test sentence 1. Test sentence 2. Long test sentence. Test sentence 1. Test sentence 2. Long test sentence. "
                }
              },
              name: 'If the time is 08:00 AM, then switch the lights on'
            }              
          ];
        },

        createRule: function() {
          this.$.ruleList.newRule();
          this.$.createButton.disabled = true;
        },

        ruleDeleted: function() {
          this.$.createButton.disabled = false;
        },

        ruleSaved: function() {
          this.$.createButton.disabled = false;
        }
      });
    })();
  </script>
</polymer-element>
